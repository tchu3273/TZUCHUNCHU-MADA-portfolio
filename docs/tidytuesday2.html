<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Tzu-Chun’s Tidy Tuesday Exercise 2</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="site_libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
<script src="site_libs/tabwid-1.0.0/tabwid.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Data Analysis Portfolio</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="./aboutme.html">About Me</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Projects
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./rcoding.html">R Coding</a>
    </li>
    <li>
      <a href="./visualization.html">Visualization</a>
    </li>
    <li>
      <a href="./tidytuesday.html">Tidy Tuesday</a>
    </li>
    <li>
      <a href="./tidytuesday2.html">Tidy Tuesday 2</a>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Influenza Data Analysis Project</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./exploration.html">Exploratory Data Analysis</a>
        </li>
        <li>
          <a href="./basicanalysisscript.html">Basic Statistical Models</a>
        </li>
        <li>
          <a href="./evaluationscript.html">Model Fitting Evaluation</a>
        </li>
        <li>
          <a href="./MLModelscript.html">Machine Learning Models</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tchu3273/TZUCHUNCHU-MADA-portfolio">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Tzu-Chun’s Tidy Tuesday Exercise 2</h1>

</div>


<p>For this week’s exercise, I will continue to work on some more tidymodeling using the marble runs dataset. You can find the original data and more information in the <a href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-06-02/readme.md">link</a>.</p>
<div id="load-required-packages" class="section level1">
<h1>load required packages</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(here) <span class="co">#to set path for importing data</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(skimr)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(readr)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(dplyr) <span class="co">#for data wrangling and cleaning</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(tidymodels) <span class="co"># for model fitting</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">library</span>(tidyverse) <span class="co"># data wrangling </span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="kw">library</span>(dotwhisker)  <span class="co"># for visualizing regression results</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw">library</span>(lme4) <span class="co"># for fitting multilevel models</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw">library</span>(gtsummary)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="kw">library</span>(gt)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="kw">library</span>(ggpubr) <span class="co"># for ggarrange function</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="kw">library</span>(tidymodels) <span class="co">#for model fitting </span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="kw">library</span>(tidyverse) <span class="co">#for data processing </span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="kw">library</span>(rsample) <span class="co">#for data splitting </span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="kw">library</span>(parsnip)</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="kw">library</span>(rpart) <span class="co"># for tree-based model</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="kw">library</span>(glmnet) <span class="co">#</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="kw">library</span>(ranger) <span class="co">#</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="kw">library</span>(dials) <span class="co"># for creating a grid of values</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="kw">library</span>(rpart.plot) <span class="co"># for visualizing decision tree</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="kw">library</span>(vip) <span class="co"># estimate variable importance based on the model’s structure</span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="kw">library</span>(ggpubr) <span class="co"># ggarrange</span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="kw">library</span>(Hmisc)</span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="kw">library</span>(naniar)</span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="kw">library</span>(tictoc)</span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="kw">library</span>(xgboost)</span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="kw">library</span>(LiblineaR)</span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="kw">library</span>(finetune)</span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="kw">library</span>(kableExtra)</span></code></pre></div>
</div>
<div id="load-data" class="section level1">
<h1>load data</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Get the Data</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>marbles &lt;-<span class="st"> </span>readr<span class="op">::</span><span class="kw">read_csv</span>(<span class="st">&#39;https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-06-02/marbles.csv&#39;</span>)</span></code></pre></div>
<pre><code>## 
## -- Column specification --------------------------------------------------------
## cols(
##   date = col_character(),
##   race = col_character(),
##   site = col_character(),
##   source = col_character(),
##   marble_name = col_character(),
##   team_name = col_character(),
##   time_s = col_double(),
##   pole = col_character(),
##   points = col_double(),
##   track_length_m = col_double(),
##   number_laps = col_double(),
##   avg_time_lap = col_double(),
##   host = col_character(),
##   notes = col_character()
## )</code></pre>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># quick descriptive information about the data</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>skimr<span class="op">::</span><span class="kw">skim</span>(marbles)</span></code></pre></div>
<table style='width: auto;'
        class='table table-condensed'>
<caption>
Data summary
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Name
</td>
<td style="text-align:left;">
marbles
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of rows
</td>
<td style="text-align:left;">
256
</td>
</tr>
<tr>
<td style="text-align:left;">
Number of columns
</td>
<td style="text-align:left;">
14
</td>
</tr>
<tr>
<td style="text-align:left;">
_______________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Column type frequency:
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
character
</td>
<td style="text-align:left;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
numeric
</td>
<td style="text-align:left;">
5
</td>
</tr>
<tr>
<td style="text-align:left;">
________________________
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Group variables
</td>
<td style="text-align:left;">
None
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
min
</th>
<th style="text-align:right;">
max
</th>
<th style="text-align:right;">
empty
</th>
<th style="text-align:right;">
n_unique
</th>
<th style="text-align:right;">
whitespace
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
date
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
race
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
site
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
source
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
marble_name
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
team_name
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
pole
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
host
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
notes
</td>
<td style="text-align:right;">
249
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
skim_variable
</th>
<th style="text-align:right;">
n_missing
</th>
<th style="text-align:right;">
complete_rate
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
p0
</th>
<th style="text-align:right;">
p25
</th>
<th style="text-align:right;">
p50
</th>
<th style="text-align:right;">
p75
</th>
<th style="text-align:right;">
p100
</th>
<th style="text-align:left;">
hist
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
time_s
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
190.84
</td>
<td style="text-align:right;">
169.13
</td>
<td style="text-align:right;">
17.76
</td>
<td style="text-align:right;">
28.40
</td>
<td style="text-align:right;">
36.28
</td>
<td style="text-align:right;">
338.16
</td>
<td style="text-align:right;">
492.01
</td>
<td style="text-align:left;">
&lt;U+2587&gt;&lt;U+2581&gt;&lt;U+2581&gt;&lt;U+2587&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
points
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:right;">
0.50
</td>
<td style="text-align:right;">
6.45
</td>
<td style="text-align:right;">
7.74
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
3.00
</td>
<td style="text-align:right;">
11.25
</td>
<td style="text-align:right;">
26.00
</td>
<td style="text-align:left;">
&lt;U+2587&gt;&lt;U+2582&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2581&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
track_length_m
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
13.22
</td>
<td style="text-align:right;">
0.95
</td>
<td style="text-align:right;">
11.90
</td>
<td style="text-align:right;">
12.62
</td>
<td style="text-align:right;">
13.02
</td>
<td style="text-align:right;">
14.13
</td>
<td style="text-align:right;">
14.55
</td>
<td style="text-align:left;">
&lt;U+2585&gt;&lt;U+2585&gt;&lt;U+2582&gt;&lt;U+2581&gt;&lt;U+2587&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
number_laps
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
6.25
</td>
<td style="text-align:right;">
5.53
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
1.00
</td>
<td style="text-align:right;">
5.00
</td>
<td style="text-align:right;">
10.25
</td>
<td style="text-align:right;">
16.00
</td>
<td style="text-align:left;">
&lt;U+2587&gt;&lt;U+2581&gt;&lt;U+2583&gt;&lt;U+2582&gt;&lt;U+2582&gt;
</td>
</tr>
<tr>
<td style="text-align:left;">
avg_time_lap
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
29.70
</td>
<td style="text-align:right;">
5.55
</td>
<td style="text-align:right;">
17.76
</td>
<td style="text-align:right;">
25.94
</td>
<td style="text-align:right;">
30.05
</td>
<td style="text-align:right;">
33.65
</td>
<td style="text-align:right;">
41.62
</td>
<td style="text-align:left;">
&lt;U+2583&gt;&lt;U+2586&gt;&lt;U+2587&gt;&lt;U+2587&gt;&lt;U+2582&gt;
</td>
</tr>
</tbody>
</table>
<p>First, let’s explore the dataset by looking at the</p>
</div>
<div id="data-exploration" class="section level1">
<h1>data exploration</h1>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># check data structure</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="kw">glimpse</span>(marbles)</span></code></pre></div>
<pre><code>## Rows: 256
## Columns: 14
## $ date           &lt;chr&gt; &quot;15-Feb-20&quot;, &quot;15-Feb-20&quot;, &quot;15-Feb-20&quot;, &quot;15-Feb-20&quot;, &quot;15~
## $ race           &lt;chr&gt; &quot;S1Q1&quot;, &quot;S1Q1&quot;, &quot;S1Q1&quot;, &quot;S1Q1&quot;, &quot;S1Q1&quot;, &quot;S1Q1&quot;, &quot;S1Q1&quot;,~
## $ site           &lt;chr&gt; &quot;Savage Speedway&quot;, &quot;Savage Speedway&quot;, &quot;Savage Speedway&quot;~
## $ source         &lt;chr&gt; &quot;https://youtu.be/JtsQ_UydjEI?t=356&quot;, &quot;https://youtu.be~
## $ marble_name    &lt;chr&gt; &quot;Clementin&quot;, &quot;Starry&quot;, &quot;Momo&quot;, &quot;Yellow&quot;, &quot;Snowy&quot;, &quot;Razz~
## $ team_name      &lt;chr&gt; &quot;O&#39;rangers&quot;, &quot;Team Galactic&quot;, &quot;Team Momo&quot;, &quot;Mellow Yell~
## $ time_s         &lt;dbl&gt; 28.11, 28.37, 28.40, 28.70, 28.71, 28.72, 28.96, 29.11,~
## $ pole           &lt;chr&gt; &quot;P1&quot;, &quot;P2&quot;, &quot;P3&quot;, &quot;P4&quot;, &quot;P5&quot;, &quot;P6&quot;, &quot;P7&quot;, &quot;P8&quot;, &quot;P9&quot;, &quot;~
## $ points         &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,~
## $ track_length_m &lt;dbl&gt; 12.81, 12.81, 12.81, 12.81, 12.81, 12.81, 12.81, 12.81,~
## $ number_laps    &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 10, 10,~
## $ avg_time_lap   &lt;dbl&gt; 28.11, 28.37, 28.40, 28.70, 28.71, 28.72, 28.96, 29.11,~
## $ host           &lt;chr&gt; &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;No&quot;, &quot;~
## $ notes          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,~</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># descriptive summary table  </span></span>
<span id="cb7-2"><a href="#cb7-2"></a>marbles <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># select only important variables</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="st">  </span><span class="kw">select</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span><span class="op">:</span><span class="dv">13</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="st">  </span><span class="kw">tbl_summary</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="st">  </span><span class="kw">modify_header</span>(label <span class="op">~</span><span class="st"> &quot;**Variable**&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="st">  </span><span class="kw">bold_labels</span>()  <span class="op">%&gt;%</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="st">  </span><span class="kw">as_flex_table</span>()</span></code></pre></div>
<p><div class="tabwid"><style>.cl-bceb7f86{font-family:'Arial';font-size:11px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-bceb7f87{font-family:'Arial';font-size:7px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;position: relative;bottom:3px;}.cl-bceb7f88{font-family:'Arial';font-size:11px;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(17, 17, 17, 1.00);background-color:transparent;}.cl-bceb7f89{font-family:'Arial';font-size:6px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3px;}.cl-bceb7f8a{font-family:'Arial';font-size:10px;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-bceba678{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-bceba679{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-bceba67a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:5px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-bceba67b{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:2px;padding-top:2px;padding-left:15px;padding-right:5px;line-height: 1.00;background-color:transparent;}.cl-bceba67c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.00;background-color:transparent;}.cl-bcecdfa2{width:80px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bcecdfa3{width:126px;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bcecdfa4{width:126px;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bcecdfa5{width:80px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bcecdfa6{width:126px;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bcecdfa7{width:80px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bcecdfa8{width:80px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bcecdfa9{width:126px;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bcecdfaa{width:126px;background-color:transparent;vertical-align: top;border-bottom: 1.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bcecdfab{width:80px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bcecdfac{width:126px;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced068a{width:80px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced068b{width:126px;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced068c{width:80px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced068d{width:80px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced068e{width:126px;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced068f{width:126px;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced0690{width:80px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced0691{width:126px;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced0692{width:80px;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced0693{width:126px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(255, 255, 255, 0.00);border-top: 1.00px solid rgba(255, 255, 255, 0.00);border-left: 1.00px solid rgba(255, 255, 255, 0.00);border-right: 1.00px solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced0694{width:80px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(255, 255, 255, 0.00);border-top: 1.00px solid rgba(255, 255, 255, 0.00);border-left: 1.00px solid rgba(255, 255, 255, 0.00);border-right: 1.00px solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced2d7c{width:126px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(0, 0, 0, 1.00);border-top: 1.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-bced2d7d{width:80px;background-color:transparent;vertical-align: middle;border-bottom: 1.00px solid rgba(0, 0, 0, 1.00);border-top: 1.00px solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table style='border-collapse:collapse;'><thead><tr style="overflow-wrap:break-word;"><td class="cl-bced2d7c"><p class="cl-bceba678"><span class="cl-bceb7f86">Variable</span></p></td><td class="cl-bced2d7d"><p class="cl-bceba679"><span class="cl-bceb7f86">N = 256</span><span class="cl-bceb7f87">1</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa3"><p class="cl-bceba67a"><span class="cl-bceb7f88">race</span></p></td><td class="cl-bcecdfa2"><p class="cl-bceba679"><span class="cl-bceb7f86"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1Q1</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1Q2</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1Q3</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1Q4</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1Q5</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1Q6</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1Q7</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1Q8</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1R1</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1R2</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1R3</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1R4</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1R5</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1R6</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1R7</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">S1R8</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfac"><p class="cl-bceba67a"><span class="cl-bceb7f88">site</span></p></td><td class="cl-bced068a"><p class="cl-bceba679"><span class="cl-bceb7f86"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Greenstone</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Hivedrive</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Midnight Bay</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Momotorway</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bced068b"><p class="cl-bceba67b"><span class="cl-bceb7f86">O'raceway</span></p></td><td class="cl-bced068c"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Razzway</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Savage Speedway</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Short Circuit</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa6"><p class="cl-bceba67a"><span class="cl-bceb7f88">marble_name</span></p></td><td class="cl-bcecdfa7"><p class="cl-bceba679"><span class="cl-bceb7f86"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Anarchy</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Billy</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Bolt</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Clementin</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Clutter</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Hazy</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Hive</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Limelime</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Mallard</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Mary</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Mimo</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Momo</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bced068b"><p class="cl-bceba67b"><span class="cl-bceb7f86">Orangin</span></p></td><td class="cl-bced068c"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Prim</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Pulsar</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Rapidly</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Razzy</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Rezzy</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Rojo Dos</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Rojo Uno</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Shock</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Smoggy</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Snowflake</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Snowy</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Speedy</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Starry</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Sublime</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Vespa</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Wispy</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Wospy</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Yellow</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Yellup</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (3.1%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bced068e"><p class="cl-bceba67a"><span class="cl-bceb7f88">team_name</span></p></td><td class="cl-bced068d"><p class="cl-bceba679"><span class="cl-bceb7f86"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Balls of Chaos</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Green Ducks</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Hazers</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Hornets</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Limers</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Mellow Yellow</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Midnight Wisps</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bced068b"><p class="cl-bceba67b"><span class="cl-bceb7f86">O'rangers</span></p></td><td class="cl-bced068c"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Raspberry Racers</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Rojo Rollers</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Savage Speeders</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Snowballs</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Team Galactic</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Team Momo</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Team Primary</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">Thunderbolts</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67a"><span class="cl-bceb7f88">time_s</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">36 (28, 338)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa9"><p class="cl-bceba67b"><span class="cl-bceb7f86">Unknown</span></p></td><td class="cl-bcecdfa8"><p class="cl-bceba679"><span class="cl-bceb7f86">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa6"><p class="cl-bceba67a"><span class="cl-bceb7f88">pole</span></p></td><td class="cl-bcecdfa7"><p class="cl-bceba679"><span class="cl-bceb7f86"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P1</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P10</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P11</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P12</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P13</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P14</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P15</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P16</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P2</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P3</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P4</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P5</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P6</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P7</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P8</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">P9</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">8 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bced068f"><p class="cl-bceba67b"><span class="cl-bceb7f86">Unknown</span></p></td><td class="cl-bced0690"><p class="cl-bceba679"><span class="cl-bceb7f86">128</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67a"><span class="cl-bceb7f88">points</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">3 (0, 11)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bced068f"><p class="cl-bceba67b"><span class="cl-bceb7f86">Unknown</span></p></td><td class="cl-bced0690"><p class="cl-bceba679"><span class="cl-bceb7f86">128</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bced0691"><p class="cl-bceba67a"><span class="cl-bceb7f88">track_length_m</span></p></td><td class="cl-bced0692"><p class="cl-bceba679"><span class="cl-bceb7f86"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">11.9</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">12.05</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">12.81</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">12.84</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">13.2</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">14.05</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">14.38</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">14.55</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa6"><p class="cl-bceba67a"><span class="cl-bceb7f88">number_laps</span></p></td><td class="cl-bcecdfa7"><p class="cl-bceba679"><span class="cl-bceb7f86"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">1</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">128 (50%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">9</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">10</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">32 (12%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">11</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">13</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">14</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67b"><span class="cl-bceb7f86">16</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa4"><p class="cl-bceba67a"><span class="cl-bceb7f88">avg_time_lap</span></p></td><td class="cl-bcecdfa5"><p class="cl-bceba679"><span class="cl-bceb7f86">30 (26, 34)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfa9"><p class="cl-bceba67b"><span class="cl-bceb7f86">Unknown</span></p></td><td class="cl-bcecdfa8"><p class="cl-bceba679"><span class="cl-bceb7f86">3</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-bcecdfaa"><p class="cl-bceba67a"><span class="cl-bceb7f88">host</span></p></td><td class="cl-bcecdfab"><p class="cl-bceba679"><span class="cl-bceb7f86">16 (6.2%)</span></p></td></tr><tr style="overflow-wrap:break-word;"><td  colspan="2"class="cl-bced0693"><p class="cl-bceba67c"><span class="cl-bceb7f89">1</span><span class="cl-bceb7f8a">n (%); Median (IQR)</span></p></td></tr></tbody></table></div></p>
<p>There are 16 races, 8 sites, 32 marble names, 16 teams, 17 different pole positions, 8 different track lengths. Next, I want to examine whether the missing data varies by race sites.</p>
</div>
<div id="examine-missing-data" class="section level1">
<h1>Examine missing data</h1>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># check percentage of missing values in each column by flu season</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="kw">aggregate</span>(marbles , <span class="dt">by=</span><span class="kw">list</span>(marbles<span class="op">$</span>site), <span class="dt">FUN =</span> <span class="cf">function</span>(x) { <span class="kw">sum</span>(<span class="kw">is.na</span>(x))<span class="op">/</span><span class="kw">length</span>(x)<span class="op">*</span><span class="dv">100</span> })</span></code></pre></div>
<pre><code>##           Group.1 date race site source marble_name team_name time_s pole
## 1      Greenstone    0    0    0      0           0         0  0.000   50
## 2       Hivedrive    0    0    0      0           0         0  3.125   50
## 3    Midnight Bay    0    0    0      0           0         0  0.000   50
## 4      Momotorway    0    0    0      0           0         0  0.000   50
## 5       O&#39;raceway    0    0    0      0           0         0  3.125   50
## 6         Razzway    0    0    0      0           0         0  0.000   50
## 7 Savage Speedway    0    0    0      0           0         0  0.000   50
## 8   Short Circuit    0    0    0      0           0         0  3.125   50
##   points track_length_m number_laps avg_time_lap host   notes
## 1     50              0           0        0.000    0 100.000
## 2     50              0           0        3.125    0 100.000
## 3     50              0           0        0.000    0  93.750
## 4     50              0           0        0.000    0 100.000
## 5     50              0           0        3.125    0 100.000
## 6     50              0           0        0.000    0  87.500
## 7     50              0           0        0.000    0 100.000
## 8     50              0           0        3.125    0  96.875</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">vis_miss</span>(marbles)</span></code></pre></div>
<p><img src="tidytuesday2_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>It looks like pole positions and points gained had 50% data missing, and there are some missingness in time in seconds and average lap time. In addition, the last two information were only missing in three sites.</p>
</div>
<div id="data-processing" class="section level1">
<h1>Data processing</h1>
<p>For further analysis, I will remove missing data since there are only less than 10% missing. Both variables, pole and points will be drop from the analysis due to substantial missing data. Let’s clean up the data now!</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>marbles.clean &lt;-<span class="st"> </span></span>
<span id="cb11-2"><a href="#cb11-2"></a>marbles <span class="op">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="st">  </span><span class="co"># exclude variables that will not be included for analysis as well</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>date, <span class="op">-</span>source, <span class="op">-</span>pole, <span class="op">-</span>points, <span class="op">-</span>notes) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="st">  </span><span class="kw">drop_na</span>(time_s, avg_time_lap)</span></code></pre></div>
<p>In Randy’s blogpost, he mentioned that he had to standardize the race times since each race track took a varying amount of time. I will also standardize the data using the same approach. First, I will calculate the average race time for different race and divide individual marble’s time by the average. This way, we will get the standardized performance in each race for each marble, checking how better or worse the marble performed compared to that race track.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>marbles.clean &lt;-<span class="st"> </span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="st">  </span>marbles.clean <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="st">  </span><span class="kw">group_by</span>(race) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="st">  </span><span class="co"># average race time for each race</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">average_race_time =</span> <span class="kw">mean</span>(time_s)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="st">  </span><span class="co"># marble&#39;s race time relative to average race time</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">std_time =</span> time_s<span class="op">/</span>average_race_time) </span></code></pre></div>
</div>
<div id="more-exploratory-data-analysis" class="section level1">
<h1>More exploratory data analysis</h1>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co"># plotting for the continuous outcome, std_time </span></span>
<span id="cb13-2"><a href="#cb13-2"></a>marbles.clean <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>std_time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">100</span>) <span class="op">+</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Standardized race time for individual marble relative to average race time&quot;</span>) <span class="op">+</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="op">+</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Histogram of standardized race time&quot;</span>) <span class="op">+</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="st">  </span><span class="kw">theme_bw</span>()</span></code></pre></div>
<p><img src="tidytuesday2_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>We can see that the standardized race time for each marble follows a normal distribution.</p>
<p>Next, I want to know which team performed the best, and whether specific marble ran faster.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co"># boxplot of standardized race time by track team</span></span>
<span id="cb14-2"><a href="#cb14-2"></a>marbles.clean <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>team_name, <span class="dt">y=</span>std_time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Standardized race time&quot;</span>) <span class="op">+</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Boxplot of standardized race time by track team&quot;</span>)</span></code></pre></div>
<p><img src="tidytuesday2_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># boxplot of standardized race time by marble</span></span>
<span id="cb15-2"><a href="#cb15-2"></a>marbles.clean <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>marble_name, <span class="dt">y=</span>std_time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Standardized race time&quot;</span>) <span class="op">+</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust=</span><span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Boxplot of standardized race time by marble&quot;</span>)</span></code></pre></div>
<p><img src="tidytuesday2_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="ml-data-modeling" class="section level1">
<h1>ML data modeling</h1>
<p>The main outcome of interest is the standardized race time, and we will fit six candidate predictors in four different ML models to determine their predictive ability. Next, I will create outcome and predictor variables needed for modeling.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># create variables for modeling</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>marbles.final &lt;-</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="st">  </span>marbles.clean <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="st">  </span><span class="kw">transmute</span>(</span>
<span id="cb16-5"><a href="#cb16-5"></a>    <span class="dt">race   =</span> <span class="kw">factor</span>(race),</span>
<span id="cb16-6"><a href="#cb16-6"></a>    <span class="dt">marble =</span> <span class="kw">factor</span>(marble_name),</span>
<span id="cb16-7"><a href="#cb16-7"></a>    <span class="dt">team   =</span> <span class="kw">factor</span>(team_name),</span>
<span id="cb16-8"><a href="#cb16-8"></a>    <span class="dt">host   =</span> <span class="kw">factor</span>(host),</span>
<span id="cb16-9"><a href="#cb16-9"></a>    <span class="dt">track_length_m =</span> <span class="kw">as.numeric</span>(track_length_m),</span>
<span id="cb16-10"><a href="#cb16-10"></a>    <span class="dt">number_laps =</span> <span class="kw">as.numeric</span>(std_time),</span>
<span id="cb16-11"><a href="#cb16-11"></a>    <span class="dt">std_time =</span> <span class="kw">as.numeric</span>(std_time)</span>
<span id="cb16-12"><a href="#cb16-12"></a>  )</span></code></pre></div>
<div id="data-setup" class="section level2">
<h2>Data setup</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co"># Data Splitting------------------------------------------------------</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">#set seed to fix random numbers </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb17-4"><a href="#cb17-4"></a></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co"># put 0.7 of data into training set, use BodyTemp as stratification</span></span>
<span id="cb17-6"><a href="#cb17-6"></a>data_split &lt;-<span class="st"> </span><span class="kw">initial_split</span>( marbles.final, </span>
<span id="cb17-7"><a href="#cb17-7"></a>                                                        <span class="dt">prop =</span> <span class="fl">0.7</span>,</span>
<span id="cb17-8"><a href="#cb17-8"></a>                                                        <span class="dt">strata =</span> std_time)</span>
<span id="cb17-9"><a href="#cb17-9"></a></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co"># create data frames for training and testing sets </span></span>
<span id="cb17-11"><a href="#cb17-11"></a>train_data &lt;-<span class="st"> </span><span class="kw">training</span>(data_split)</span>
<span id="cb17-12"><a href="#cb17-12"></a>test_data &lt;-<span class="st"> </span><span class="kw">testing</span>(data_split)</span>
<span id="cb17-13"><a href="#cb17-13"></a></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="co"># create 5-fold cross-validation, 5 times repeated</span></span>
<span id="cb17-15"><a href="#cb17-15"></a>folds &lt;-<span class="st"> </span><span class="kw">vfold_cv</span>(train_data, <span class="dt">v =</span> <span class="dv">5</span>, <span class="dt">repeats =</span><span class="dv">5</span>, <span class="dt">strata =</span> std_time)</span>
<span id="cb17-16"><a href="#cb17-16"></a></span>
<span id="cb17-17"><a href="#cb17-17"></a><span class="co"># create recipe fitting BodyTemp to all predictors </span></span>
<span id="cb17-18"><a href="#cb17-18"></a>rec &lt;-<span class="st"> </span>recipes<span class="op">::</span><span class="kw">recipe</span>(std_time <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> train_data)</span>
<span id="cb17-19"><a href="#cb17-19"></a></span>
<span id="cb17-20"><a href="#cb17-20"></a><span class="co"># create dummy variable for all predictors</span></span>
<span id="cb17-21"><a href="#cb17-21"></a>rec_all_pred &lt;-<span class="st"> </span>rec <span class="op">%&gt;%</span></span>
<span id="cb17-22"><a href="#cb17-22"></a><span class="st">    </span><span class="co">#converts characters or factors </span></span>
<span id="cb17-23"><a href="#cb17-23"></a><span class="st">  </span><span class="kw">step_dummy</span>(<span class="kw">all_nominal</span>()) <span class="op">%&gt;%</span></span>
<span id="cb17-24"><a href="#cb17-24"></a><span class="st">    </span><span class="co">#removes indicator variables that only contain a single unique value</span></span>
<span id="cb17-25"><a href="#cb17-25"></a><span class="st">  </span><span class="kw">step_zv</span>(<span class="kw">all_predictors</span>())</span></code></pre></div>
</div>
</div>
<div id="model-tuning-and-fitting" class="section level1">
<h1>Model tuning and fitting</h1>
<div id="decision-tree" class="section level2">
<h2>Decision tree</h2>
<p>I first followed the tidymodels tutorial for training the model using tree regression method, but I got the error of the "“a correlation computation is required, but ‘estimate’ is constant and has…” when I used dials to search for all tuning combinations to try for each hyperparameter, and the final tree didn’t perform well, and only include sneeze as only predictor. I would like to thank Zane for the inspiration, I used “grid_latin_hypercube” for defining a grid of potential parameter values, and the codes ran without any error.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># model specification </span></span>
<span id="cb18-2"><a href="#cb18-2"></a>tree_spec &lt;-<span class="st"> </span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="st">  </span><span class="kw">decision_tree</span>(</span>
<span id="cb18-4"><a href="#cb18-4"></a>    <span class="dt">cost_complexity =</span> <span class="kw">tune</span>(),</span>
<span id="cb18-5"><a href="#cb18-5"></a>    <span class="dt">tree_depth =</span> <span class="kw">tune</span>(),</span>
<span id="cb18-6"><a href="#cb18-6"></a>    <span class="dt">min_n =</span> <span class="kw">tune</span>() <span class="co"># sets the minimum n to split at any node.</span></span>
<span id="cb18-7"><a href="#cb18-7"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="st">  </span><span class="kw">set_engine</span>(<span class="st">&quot;rpart&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="st">  </span><span class="kw">set_mode</span>(<span class="st">&quot;regression&quot;</span>)</span>
<span id="cb18-10"><a href="#cb18-10"></a></span>
<span id="cb18-11"><a href="#cb18-11"></a>tree_spec</span></code></pre></div>
<pre><code>## Decision Tree Model Specification (regression)
## 
## Main Arguments:
##   cost_complexity = tune()
##   tree_depth = tune()
##   min_n = tune()
## 
## Computational engine: rpart</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># we will train this specification on several re-sampled data</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>tree_wf &lt;-<span class="st"> </span><span class="kw">workflow</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="st">  </span><span class="kw">add_model</span>(tree_spec) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="st">  </span><span class="kw">add_recipe</span>(rec_all_pred)</span>
<span id="cb20-5"><a href="#cb20-5"></a></span>
<span id="cb20-6"><a href="#cb20-6"></a></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co"># define a grid of potential parameter values using latin hypercube sampling</span></span>
<span id="cb20-8"><a href="#cb20-8"></a>tree_grid &lt;-<span class="st"> </span><span class="kw">grid_latin_hypercube</span>(</span>
<span id="cb20-9"><a href="#cb20-9"></a>  <span class="kw">cost_complexity</span>(), <span class="kw">tree_depth</span>(), <span class="kw">min_n</span>(), <span class="dt">size =</span> <span class="dv">10</span></span>
<span id="cb20-10"><a href="#cb20-10"></a>)</span>
<span id="cb20-11"><a href="#cb20-11"></a></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co"># Grid search for parameter values</span></span>
<span id="cb20-13"><a href="#cb20-13"></a>tree_res &lt;-<span class="st"> </span>tree_wf <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="st">  </span><span class="kw">tune_grid</span>(</span>
<span id="cb20-15"><a href="#cb20-15"></a>    <span class="dt">resamples =</span> folds,</span>
<span id="cb20-16"><a href="#cb20-16"></a>    <span class="dt">grid =</span> tree_grid,</span>
<span id="cb20-17"><a href="#cb20-17"></a>    <span class="dt">metrics =</span> <span class="kw">metric_set</span>(rmse),</span>
<span id="cb20-18"><a href="#cb20-18"></a>    <span class="dt">control =</span> <span class="kw">control_grid</span>(<span class="dt">verbose =</span> <span class="ot">TRUE</span>),</span>
<span id="cb20-19"><a href="#cb20-19"></a> )</span>
<span id="cb20-20"><a href="#cb20-20"></a></span>
<span id="cb20-21"><a href="#cb20-21"></a></span>
<span id="cb20-22"><a href="#cb20-22"></a><span class="co"># Select single set of hyperparameter values for our best decision tree model</span></span>
<span id="cb20-23"><a href="#cb20-23"></a>best_tree &lt;-<span class="st"> </span><span class="kw">select_best</span>(tree_res)</span>
<span id="cb20-24"><a href="#cb20-24"></a></span>
<span id="cb20-25"><a href="#cb20-25"></a><span class="co"># Finalize our workflow with best values</span></span>
<span id="cb20-26"><a href="#cb20-26"></a>final_tree_wf &lt;-<span class="st"> </span>tree_wf <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-27"><a href="#cb20-27"></a><span class="st">  </span><span class="kw">finalize_workflow</span>(best_tree)</span>
<span id="cb20-28"><a href="#cb20-28"></a></span>
<span id="cb20-29"><a href="#cb20-29"></a><span class="co"># Fit model to training data</span></span>
<span id="cb20-30"><a href="#cb20-30"></a>best_tree_train_fit &lt;-<span class="st"> </span>final_tree_wf <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb20-31"><a href="#cb20-31"></a><span class="st">    </span><span class="kw">fit</span>(<span class="dt">data =</span> train_data)</span>
<span id="cb20-32"><a href="#cb20-32"></a></span>
<span id="cb20-33"><a href="#cb20-33"></a></span>
<span id="cb20-34"><a href="#cb20-34"></a><span class="kw">png</span>(<span class="dt">filename =</span> here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;tree_algorithms.png&quot;</span>), <span class="dt">width =</span> <span class="dv">1200</span>, <span class="dt">height =</span> <span class="dv">1000</span>)</span>
<span id="cb20-35"><a href="#cb20-35"></a></span>
<span id="cb20-36"><a href="#cb20-36"></a>rpart.plot<span class="op">::</span><span class="kw">rpart.plot</span>(</span>
<span id="cb20-37"><a href="#cb20-37"></a>  <span class="dt">x =</span> <span class="kw">extract_fit_parsnip</span>(best_tree_train_fit)<span class="op">$</span>fit,</span>
<span id="cb20-38"><a href="#cb20-38"></a>  <span class="dt">main =</span> <span class="st">&quot;Final tree-based model&quot;</span>,</span>
<span id="cb20-39"><a href="#cb20-39"></a>  <span class="dt">roundint =</span> F,</span>
<span id="cb20-40"><a href="#cb20-40"></a>  <span class="dt">type =</span> <span class="dv">5</span>,</span>
<span id="cb20-41"><a href="#cb20-41"></a>  <span class="dt">digits =</span> <span class="dv">4</span></span>
<span id="cb20-42"><a href="#cb20-42"></a>)</span>
<span id="cb20-43"><a href="#cb20-43"></a><span class="kw">dev.off</span>()</span></code></pre></div>
<pre><code>## png 
##   2</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>( here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;tree_algorithms.png&quot;</span>))</span></code></pre></div>
<p><img src="tidytuesday2_figures/tree_algorithms.png" width="600" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># estimate model importance based on the model&#39;s structure</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>vip_tree &lt;-</span>
<span id="cb23-3"><a href="#cb23-3"></a>best_tree_train_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="st">  </span><span class="kw">extract_fit_parsnip</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="st">  </span><span class="kw">vip</span>()</span>
<span id="cb23-6"><a href="#cb23-6"></a></span>
<span id="cb23-7"><a href="#cb23-7"></a>vip_tree</span></code></pre></div>
<p><img src="tidytuesday2_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<p>Number of laps is the strongest predictor of the race time.</p>
</div>
<div id="diagnostics-plots" class="section level2">
<h2>Diagnostics plots</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co"># some more diagnostics</span></span>
<span id="cb24-2"><a href="#cb24-2"></a>tree_diagnostics &lt;-<span class="st"> </span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="st">  </span>tree_res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</span>
<span id="cb24-4"><a href="#cb24-4"></a></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="kw">ggsave</span>(<span class="dt">filename =</span> here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;tree_diagnostics.png&quot;</span>),</span>
<span id="cb24-6"><a href="#cb24-6"></a>       <span class="dt">plot =</span> tree_diagnostics,</span>
<span id="cb24-7"><a href="#cb24-7"></a>       <span class="dt">width =</span> <span class="dv">12</span>, <span class="dt">height =</span> <span class="dv">6</span>)</span>
<span id="cb24-8"><a href="#cb24-8"></a></span>
<span id="cb24-9"><a href="#cb24-9"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>( here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;tree_diagnostics.png&quot;</span>))</span></code></pre></div>
<p><img src="tidytuesday2_figures/tree_diagnostics.png" width="1800" /></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># pull predictions and residuals</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>tree_train_res &lt;-<span class="st"> </span>best_tree_train_fit  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="st">  </span><span class="kw">augment</span>(<span class="dt">new_data =</span> train_data) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="st">         </span><span class="kw">select</span>(.pred, std_time) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="st">         </span><span class="kw">mutate</span>(<span class="dt">.resid =</span> std_time <span class="op">-</span><span class="st"> </span>.pred)</span>
<span id="cb25-6"><a href="#cb25-6"></a></span>
<span id="cb25-7"><a href="#cb25-7"></a></span>
<span id="cb25-8"><a href="#cb25-8"></a><span class="co"># plot Predictions vs observed values</span></span>
<span id="cb25-9"><a href="#cb25-9"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(tree_train_res, <span class="kw">aes</span>(<span class="dt">x =</span> std_time, <span class="dt">y =</span> .pred)) <span class="op">+</span></span>
<span id="cb25-10"><a href="#cb25-10"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb25-11"><a href="#cb25-11"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">theme_cowplot</span>() <span class="op">+</span></span>
<span id="cb25-13"><a href="#cb25-13"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb25-14"><a href="#cb25-14"></a>    <span class="dt">title =</span> <span class="st">&quot;Decision tree: predicted vs observed&quot;</span>,</span>
<span id="cb25-15"><a href="#cb25-15"></a>    <span class="dt">x =</span> <span class="st">&quot;Observed&quot;</span>,</span>
<span id="cb25-16"><a href="#cb25-16"></a>    <span class="dt">y =</span> <span class="st">&quot;Fitted&quot;</span></span>
<span id="cb25-17"><a href="#cb25-17"></a>  )</span>
<span id="cb25-18"><a href="#cb25-18"></a></span>
<span id="cb25-19"><a href="#cb25-19"></a><span class="co"># Plot model predictions vs residuals</span></span>
<span id="cb25-20"><a href="#cb25-20"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(tree_train_res, <span class="kw">aes</span>(<span class="dt">y =</span> .resid, <span class="dt">x =</span> .pred)) <span class="op">+</span></span>
<span id="cb25-21"><a href="#cb25-21"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb25-22"><a href="#cb25-22"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb25-23"><a href="#cb25-23"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">theme_cowplot</span>() <span class="op">+</span></span>
<span id="cb25-24"><a href="#cb25-24"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb25-25"><a href="#cb25-25"></a>    <span class="dt">title =</span> <span class="st">&quot;Decision tree: residuals vs fitted&quot;</span>,</span>
<span id="cb25-26"><a href="#cb25-26"></a>    <span class="dt">y =</span> <span class="st">&quot;Residuals&quot;</span>,</span>
<span id="cb25-27"><a href="#cb25-27"></a>    <span class="dt">x =</span> <span class="st">&quot;Fitted&quot;</span></span>
<span id="cb25-28"><a href="#cb25-28"></a>  )</span>
<span id="cb25-29"><a href="#cb25-29"></a></span>
<span id="cb25-30"><a href="#cb25-30"></a><span class="co"># combine graphs</span></span>
<span id="cb25-31"><a href="#cb25-31"></a>tree_panel &lt;-<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>), <span class="dt">label_size =</span> <span class="dv">12</span>, <span class="dt">ncol =</span><span class="dv">2</span>)</span>
<span id="cb25-32"><a href="#cb25-32"></a></span>
<span id="cb25-33"><a href="#cb25-33"></a><span class="kw">ggsave</span>(<span class="dt">filename =</span> here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;tree_panel.png&quot;</span>),</span>
<span id="cb25-34"><a href="#cb25-34"></a>       <span class="dt">plot =</span> tree_panel,</span>
<span id="cb25-35"><a href="#cb25-35"></a>       <span class="dt">width =</span> <span class="dv">12</span>, <span class="dt">height =</span> <span class="dv">6</span>)</span>
<span id="cb25-36"><a href="#cb25-36"></a></span>
<span id="cb25-37"><a href="#cb25-37"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>( here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;tree_panel.png&quot;</span>))</span></code></pre></div>
<p><img src="tidytuesday2_figures/tree_panel.png" width="1800" /></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># looking at model performance</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>tree_perfomance &lt;-<span class="st"> </span>tree_res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">show_best</span>(<span class="dt">n =</span> <span class="dv">1</span>)</span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="kw">print</span>(tree_perfomance) <span class="co"># rmse: 0.0068</span></span></code></pre></div>
<pre><code>## # A tibble: 1 x 9
##   cost_complexity tree_depth min_n .metric .estimator    mean     n  std_err
##             &lt;dbl&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;
## 1       0.0000297          4     9 rmse    standard   0.00685    25 0.000517
## # ... with 1 more variable: .config &lt;chr&gt;</code></pre>
<p>The RMSE of the regression tree model is small and the predicted vs observed plot looks good. All the data points seem to align with the diagonal line.</p>
</div>
<div id="lasso-model" class="section level2">
<h2>LASSO model</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co"># LASSO model specification </span></span>
<span id="cb28-2"><a href="#cb28-2"></a>lasso_spec &lt;-<span class="st"> </span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="st">  </span><span class="kw">linear_reg</span>(</span>
<span id="cb28-4"><a href="#cb28-4"></a>    <span class="dt">penalty =</span> <span class="kw">tune</span>(),</span>
<span id="cb28-5"><a href="#cb28-5"></a>    <span class="dt">mixture =</span> <span class="dv">1</span> <span class="co"># make this LASSO</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="st">  </span><span class="kw">set_engine</span>(<span class="st">&quot;glmnet&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="st">  </span><span class="kw">set_mode</span>(<span class="st">&quot;regression&quot;</span>)</span>
<span id="cb28-9"><a href="#cb28-9"></a></span>
<span id="cb28-10"><a href="#cb28-10"></a>lasso_spec</span></code></pre></div>
<pre><code>## Linear Regression Model Specification (regression)
## 
## Main Arguments:
##   penalty = tune()
##   mixture = 1
## 
## Computational engine: glmnet</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>lasso_wf &lt;-<span class="st"> </span><span class="kw">workflow</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="st">  </span><span class="kw">add_model</span>(lasso_spec) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="st">  </span><span class="kw">add_recipe</span>(rec_all_pred)</span>
<span id="cb30-4"><a href="#cb30-4"></a></span>
<span id="cb30-5"><a href="#cb30-5"></a><span class="co"># only one hyperparameter to tune here, we can set the grid up manually using a one-column # tibble with 30 candidate values</span></span>
<span id="cb30-6"><a href="#cb30-6"></a>lasso_grid &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">penalty =</span> <span class="dv">10</span><span class="op">^</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">-1</span>, <span class="dt">length.out =</span> <span class="dv">30</span>))</span>
<span id="cb30-7"><a href="#cb30-7"></a></span>
<span id="cb30-8"><a href="#cb30-8"></a><span class="co"># use grid search to tune hyperparameters using cross-validation </span></span>
<span id="cb30-9"><a href="#cb30-9"></a>lasso_res &lt;-<span class="st"> </span>lasso_wf <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-10"><a href="#cb30-10"></a><span class="st">  </span>tune<span class="op">::</span><span class="kw">tune_grid</span>(</span>
<span id="cb30-11"><a href="#cb30-11"></a>    <span class="dt">resamples =</span> folds,</span>
<span id="cb30-12"><a href="#cb30-12"></a>    <span class="dt">grid =</span> lasso_grid,</span>
<span id="cb30-13"><a href="#cb30-13"></a>    <span class="dt">metrics =</span>  <span class="kw">metric_set</span>(rmse),</span>
<span id="cb30-14"><a href="#cb30-14"></a>    <span class="dt">control =</span> <span class="kw">control_grid</span>(<span class="dt">verbose =</span> <span class="ot">TRUE</span>)</span>
<span id="cb30-15"><a href="#cb30-15"></a>  )</span>
<span id="cb30-16"><a href="#cb30-16"></a></span>
<span id="cb30-17"><a href="#cb30-17"></a><span class="co"># pull the best tuning parameter values</span></span>
<span id="cb30-18"><a href="#cb30-18"></a>best_lasso &lt;-<span class="st"> </span><span class="kw">select_best</span>(lasso_res)</span>
<span id="cb30-19"><a href="#cb30-19"></a></span>
<span id="cb30-20"><a href="#cb30-20"></a><span class="co"># Finalize workflow with best values</span></span>
<span id="cb30-21"><a href="#cb30-21"></a>final_lasso_wf &lt;-<span class="st"> </span>lasso_wf  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb30-22"><a href="#cb30-22"></a><span class="st">  </span><span class="kw">finalize_workflow</span>(best_lasso)</span>
<span id="cb30-23"><a href="#cb30-23"></a></span>
<span id="cb30-24"><a href="#cb30-24"></a><span class="co"># Fit model to training data</span></span>
<span id="cb30-25"><a href="#cb30-25"></a>best_lasso_train_fit &lt;-<span class="st"> </span>final_lasso_wf <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">fit</span>(<span class="dt">data =</span> train_data)</span></code></pre></div>
</div>
<div id="diagnostics-plots-1" class="section level2">
<h2>Diagnostics plots</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="co"># LASSO variable trace plot</span></span>
<span id="cb31-2"><a href="#cb31-2"></a>x &lt;-<span class="st"> </span>best_lasso_train_fit<span class="op">$</span>fit<span class="op">$</span>fit<span class="op">$</span>fit</span>
<span id="cb31-3"><a href="#cb31-3"></a><span class="kw">plot</span>(x, <span class="st">&quot;lambda&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in plotCoef(x$beta, lambda = x$lambda, df = x$df, dev = x$dev.ratio, : 1
## or less nonzero coefficients; glmnet plot is not meaningful</code></pre>
<p><img src="tidytuesday2_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
</div>
<div id="more-diagnostics-plots" class="section level2">
<h2>More diagnostics plots</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># some more diagnostics</span></span>
<span id="cb33-2"><a href="#cb33-2"></a>lasso_diagnostics &lt;-<span class="st"> </span></span>
<span id="cb33-3"><a href="#cb33-3"></a>lasso_res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</span>
<span id="cb33-4"><a href="#cb33-4"></a></span>
<span id="cb33-5"><a href="#cb33-5"></a><span class="kw">ggsave</span>(<span class="dt">filename =</span> here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;lasso_diagnostics.png&quot;</span>),</span>
<span id="cb33-6"><a href="#cb33-6"></a>       <span class="dt">plot =</span> lasso_diagnostics,</span>
<span id="cb33-7"><a href="#cb33-7"></a>       <span class="dt">width =</span> <span class="dv">12</span>, <span class="dt">height =</span> <span class="dv">6</span>)</span>
<span id="cb33-8"><a href="#cb33-8"></a></span>
<span id="cb33-9"><a href="#cb33-9"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>( here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;lasso_diagnostics.png&quot;</span>))</span></code></pre></div>
<p><img src="tidytuesday2_figures/lasso_diagnostics.png" width="1800" /></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co"># pull predictions and residuals</span></span>
<span id="cb34-2"><a href="#cb34-2"></a>lasso_train_res &lt;-<span class="st"> </span>best_lasso_train_fit  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="st">  </span><span class="kw">augment</span>(<span class="dt">new_data =</span> train_data) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-4"><a href="#cb34-4"></a><span class="st">         </span><span class="kw">select</span>(.pred, std_time) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb34-5"><a href="#cb34-5"></a><span class="st">         </span><span class="kw">mutate</span>(<span class="dt">.resid =</span> std_time <span class="op">-</span><span class="st"> </span>.pred)</span>
<span id="cb34-6"><a href="#cb34-6"></a></span>
<span id="cb34-7"><a href="#cb34-7"></a></span>
<span id="cb34-8"><a href="#cb34-8"></a><span class="co"># plot Predictions vs observed values</span></span>
<span id="cb34-9"><a href="#cb34-9"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(lasso_train_res, <span class="kw">aes</span>(<span class="dt">x =</span> std_time, <span class="dt">y =</span> .pred)) <span class="op">+</span></span>
<span id="cb34-10"><a href="#cb34-10"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb34-11"><a href="#cb34-11"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb34-12"><a href="#cb34-12"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">theme_cowplot</span>() <span class="op">+</span></span>
<span id="cb34-13"><a href="#cb34-13"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb34-14"><a href="#cb34-14"></a>    <span class="dt">title =</span> <span class="st">&quot;LASSO: predicted vs observed&quot;</span>,</span>
<span id="cb34-15"><a href="#cb34-15"></a>    <span class="dt">x =</span> <span class="st">&quot;Observed&quot;</span>,</span>
<span id="cb34-16"><a href="#cb34-16"></a>    <span class="dt">y =</span> <span class="st">&quot;Fitted&quot;</span></span>
<span id="cb34-17"><a href="#cb34-17"></a>  )</span>
<span id="cb34-18"><a href="#cb34-18"></a></span>
<span id="cb34-19"><a href="#cb34-19"></a><span class="co"># Plot model predictions vs residuals</span></span>
<span id="cb34-20"><a href="#cb34-20"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(lasso_train_res, <span class="kw">aes</span>(<span class="dt">y =</span> .resid, <span class="dt">x =</span> .pred)) <span class="op">+</span></span>
<span id="cb34-21"><a href="#cb34-21"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb34-22"><a href="#cb34-22"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb34-23"><a href="#cb34-23"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">theme_cowplot</span>() <span class="op">+</span></span>
<span id="cb34-24"><a href="#cb34-24"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb34-25"><a href="#cb34-25"></a>    <span class="dt">title =</span> <span class="st">&quot;LASSO: residuals vs fitted&quot;</span>,</span>
<span id="cb34-26"><a href="#cb34-26"></a>    <span class="dt">y =</span> <span class="st">&quot;Residuals&quot;</span>,</span>
<span id="cb34-27"><a href="#cb34-27"></a>    <span class="dt">x =</span> <span class="st">&quot;Fitted&quot;</span></span>
<span id="cb34-28"><a href="#cb34-28"></a>  )</span>
<span id="cb34-29"><a href="#cb34-29"></a></span>
<span id="cb34-30"><a href="#cb34-30"></a><span class="co"># combine graphs</span></span>
<span id="cb34-31"><a href="#cb34-31"></a>lasso_panel &lt;-<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>), <span class="dt">label_size =</span> <span class="dv">12</span>, <span class="dt">ncol =</span><span class="dv">2</span>)</span>
<span id="cb34-32"><a href="#cb34-32"></a></span>
<span id="cb34-33"><a href="#cb34-33"></a><span class="kw">ggsave</span>(<span class="dt">filename =</span> here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;lasso_panel.png&quot;</span>),</span>
<span id="cb34-34"><a href="#cb34-34"></a>       <span class="dt">plot =</span> lasso_panel,</span>
<span id="cb34-35"><a href="#cb34-35"></a>       <span class="dt">width =</span> <span class="dv">12</span>, <span class="dt">height =</span> <span class="dv">6</span>)</span>
<span id="cb34-36"><a href="#cb34-36"></a></span>
<span id="cb34-37"><a href="#cb34-37"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>( here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;lasso_panel.png&quot;</span>))</span></code></pre></div>
<p><img src="tidytuesday2_figures/lasso_panel.png" width="1800" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="co"># looking at model performance</span></span>
<span id="cb35-2"><a href="#cb35-2"></a>lasso_perfomance &lt;-<span class="st"> </span>lasso_res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">show_best</span>(<span class="dt">n =</span> <span class="dv">1</span>)</span>
<span id="cb35-3"><a href="#cb35-3"></a><span class="kw">print</span>(lasso_perfomance) <span class="co"># rmse: 0.0008</span></span></code></pre></div>
<pre><code>## # A tibble: 1 x 7
##   penalty .metric .estimator     mean     n   std_err .config              
##     &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;                
## 1  0.0001 rmse    standard   0.000867    25 0.0000252 Preprocessor1_Model01</code></pre>
<p>The RMSE is smaller compared to the single tree model, however the residual plot looks weird.</p>
</div>
<div id="random-forrest" class="section level2">
<h2>Random forrest</h2>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="co"># query number of cores and see how much paralleization that can be done</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>cores &lt;-<span class="st"> </span>parallel<span class="op">::</span><span class="kw">detectCores</span>()</span>
<span id="cb37-3"><a href="#cb37-3"></a>cores <span class="co"># 4</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="co"># pass information to ranger engine to set up the model</span></span>
<span id="cb39-2"><a href="#cb39-2"></a>rf_mod &lt;-<span class="st"> </span></span>
<span id="cb39-3"><a href="#cb39-3"></a><span class="st">  </span><span class="kw">rand_forest</span>(<span class="dt">mtry =</span> <span class="kw">tune</span>(), <span class="dt">min_n =</span> <span class="kw">tune</span>(), <span class="dt">trees =</span> <span class="dv">1000</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-4"><a href="#cb39-4"></a><span class="st">  </span><span class="kw">set_engine</span>(<span class="st">&quot;ranger&quot;</span>, <span class="dt">num.threads =</span> cores, <span class="dt">importance =</span> <span class="st">&quot;permutation&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-5"><a href="#cb39-5"></a><span class="st">  </span><span class="kw">set_mode</span>(<span class="st">&quot;regression&quot;</span>)</span>
<span id="cb39-6"><a href="#cb39-6"></a></span>
<span id="cb39-7"><a href="#cb39-7"></a><span class="co"># create workflow to bundle model spec and recipe</span></span>
<span id="cb39-8"><a href="#cb39-8"></a>rf_wf &lt;-<span class="st"> </span><span class="kw">workflow</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-9"><a href="#cb39-9"></a><span class="st">  </span><span class="kw">add_model</span>(rf_mod) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb39-10"><a href="#cb39-10"></a><span class="st">  </span><span class="kw">add_recipe</span>(rec_all_pred)</span>
<span id="cb39-11"><a href="#cb39-11"></a></span>
<span id="cb39-12"><a href="#cb39-12"></a><span class="co"># show what will be tuned</span></span>
<span id="cb39-13"><a href="#cb39-13"></a>rf_mod <span class="op">%&gt;%</span><span class="st">    </span></span>
<span id="cb39-14"><a href="#cb39-14"></a><span class="st">  </span><span class="kw">parameters</span>()  </span></code></pre></div>
<pre><code>## Collection of 2 parameters for tuning
## 
##  identifier  type    object
##        mtry  mtry nparam[?]
##       min_n min_n nparam[+]
## 
## Model parameters needing finalization:
##    # Randomly Selected Predictors (&#39;mtry&#39;)
## 
## See `?dials::finalize` or `?dials::update.parameters` for more information.</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="co"># use a space-filling design to tune, with 25 candidate models</span></span>
<span id="cb41-2"><a href="#cb41-2"></a>rf_res &lt;-<span class="st"> </span></span>
<span id="cb41-3"><a href="#cb41-3"></a><span class="st">  </span>rf_wf <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-4"><a href="#cb41-4"></a><span class="st">  </span><span class="kw">tune_grid</span>(folds,</span>
<span id="cb41-5"><a href="#cb41-5"></a>            <span class="dt">grid =</span> <span class="dv">25</span>,</span>
<span id="cb41-6"><a href="#cb41-6"></a>            <span class="dt">control =</span> <span class="kw">control_grid</span>(<span class="dt">save_pred =</span> <span class="ot">TRUE</span>),</span>
<span id="cb41-7"><a href="#cb41-7"></a>            <span class="dt">metrics =</span> <span class="kw">metric_set</span>(rmse))</span>
<span id="cb41-8"><a href="#cb41-8"></a></span>
<span id="cb41-9"><a href="#cb41-9"></a><span class="co"># 5 random forest models, out of the 25 candidates:</span></span>
<span id="cb41-10"><a href="#cb41-10"></a>rf_res <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb41-11"><a href="#cb41-11"></a><span class="st">  </span><span class="kw">show_best</span>(<span class="dt">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 x 8
##    mtry min_n .metric .estimator    mean     n  std_err .config              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;                
## 1    63     8 rmse    standard   0.00520    25 0.000515 Preprocessor1_Model09
## 2    61    10 rmse    standard   0.00563    25 0.000540 Preprocessor1_Model10
## 3    57    15 rmse    standard   0.00651    25 0.000593 Preprocessor1_Model08
## 4    49    17 rmse    standard   0.00756    25 0.000659 Preprocessor1_Model17
## 5    45    13 rmse    standard   0.00763    25 0.000656 Preprocessor1_Model24</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="co"># select the best model according to RMSE metric, and the final tuning parameter values are:</span></span>
<span id="cb43-2"><a href="#cb43-2"></a>best_rf &lt;-<span class="st"> </span></span>
<span id="cb43-3"><a href="#cb43-3"></a><span class="st">  </span>rf_res <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb43-4"><a href="#cb43-4"></a><span class="st">  </span><span class="kw">select_best</span>(<span class="dt">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb43-5"><a href="#cb43-5"></a></span>
<span id="cb43-6"><a href="#cb43-6"></a>best_rf</span></code></pre></div>
<pre><code>## # A tibble: 1 x 3
##    mtry min_n .config              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;                
## 1    63     8 Preprocessor1_Model09</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="co"># Finalize workflow with best values</span></span>
<span id="cb45-2"><a href="#cb45-2"></a>final_rf_wf &lt;-<span class="st"> </span>rf_wf  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb45-3"><a href="#cb45-3"></a><span class="st">  </span><span class="kw">finalize_workflow</span>(best_rf)</span>
<span id="cb45-4"><a href="#cb45-4"></a></span>
<span id="cb45-5"><a href="#cb45-5"></a><span class="co"># Fit model to training data</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>best_rf_train_fit &lt;-<span class="st"> </span>final_rf_wf <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">fit</span>(<span class="dt">data =</span> train_data)</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># estimate model importance based on the model&#39;s structure</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>vip_rf &lt;-</span>
<span id="cb46-3"><a href="#cb46-3"></a>best_rf_train_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-4"><a href="#cb46-4"></a><span class="st">  </span><span class="kw">extract_fit_parsnip</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb46-5"><a href="#cb46-5"></a><span class="st">  </span><span class="kw">vip</span>()</span>
<span id="cb46-6"><a href="#cb46-6"></a></span>
<span id="cb46-7"><a href="#cb46-7"></a>vip_tree</span></code></pre></div>
<p><img src="tidytuesday2_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>Number of laps is the strongest predictor.</p>
</div>
<div id="diagnostics-plots-2" class="section level2">
<h2>Diagnostics plots</h2>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co"># some more diagnostics</span></span>
<span id="cb47-2"><a href="#cb47-2"></a>rf_diagnostics &lt;-<span class="st"> </span></span>
<span id="cb47-3"><a href="#cb47-3"></a>rf_res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</span>
<span id="cb47-4"><a href="#cb47-4"></a><span class="kw">ggsave</span>(<span class="dt">filename =</span> here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;random_forest_diagnostics.png&quot;</span>),</span>
<span id="cb47-5"><a href="#cb47-5"></a>       <span class="dt">plot =</span> rf_diagnostics,</span>
<span id="cb47-6"><a href="#cb47-6"></a>       <span class="dt">width =</span> <span class="dv">12</span>, <span class="dt">height =</span> <span class="dv">6</span>)</span>
<span id="cb47-7"><a href="#cb47-7"></a></span>
<span id="cb47-8"><a href="#cb47-8"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>( here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;random_forest_diagnostics.png&quot;</span>))</span></code></pre></div>
<p><img src="tidytuesday2_figures/random_forest_diagnostics.png" width="1800" /></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="co"># pull predictions and residuals</span></span>
<span id="cb48-2"><a href="#cb48-2"></a>rf_train_res &lt;-<span class="st"> </span>best_rf_train_fit  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-3"><a href="#cb48-3"></a><span class="st">  </span><span class="kw">augment</span>(<span class="dt">new_data =</span> train_data) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-4"><a href="#cb48-4"></a><span class="st">         </span><span class="kw">select</span>(.pred, std_time) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb48-5"><a href="#cb48-5"></a><span class="st">         </span><span class="kw">mutate</span>(<span class="dt">.resid =</span> std_time <span class="op">-</span><span class="st"> </span>.pred)</span>
<span id="cb48-6"><a href="#cb48-6"></a></span>
<span id="cb48-7"><a href="#cb48-7"></a></span>
<span id="cb48-8"><a href="#cb48-8"></a><span class="co"># plot Predictions vs observed values</span></span>
<span id="cb48-9"><a href="#cb48-9"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(rf_train_res, <span class="kw">aes</span>(<span class="dt">x =</span> std_time, <span class="dt">y =</span> .pred)) <span class="op">+</span></span>
<span id="cb48-10"><a href="#cb48-10"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb48-11"><a href="#cb48-11"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb48-12"><a href="#cb48-12"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">theme_cowplot</span>() <span class="op">+</span></span>
<span id="cb48-13"><a href="#cb48-13"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb48-14"><a href="#cb48-14"></a>    <span class="dt">title =</span> <span class="st">&quot;Random forest: predicted vs observed&quot;</span>,</span>
<span id="cb48-15"><a href="#cb48-15"></a>    <span class="dt">x =</span> <span class="st">&quot;Observed&quot;</span>,</span>
<span id="cb48-16"><a href="#cb48-16"></a>    <span class="dt">y =</span> <span class="st">&quot;Fitted&quot;</span></span>
<span id="cb48-17"><a href="#cb48-17"></a>  )</span>
<span id="cb48-18"><a href="#cb48-18"></a></span>
<span id="cb48-19"><a href="#cb48-19"></a><span class="co"># Plot model predictions vs residuals</span></span>
<span id="cb48-20"><a href="#cb48-20"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(rf_train_res, <span class="kw">aes</span>(<span class="dt">y =</span> .resid, <span class="dt">x =</span> .pred)) <span class="op">+</span></span>
<span id="cb48-21"><a href="#cb48-21"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb48-22"><a href="#cb48-22"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb48-23"><a href="#cb48-23"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">theme_cowplot</span>() <span class="op">+</span></span>
<span id="cb48-24"><a href="#cb48-24"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb48-25"><a href="#cb48-25"></a>    <span class="dt">title =</span> <span class="st">&quot;Random forest: residuals vs fitted&quot;</span>,</span>
<span id="cb48-26"><a href="#cb48-26"></a>    <span class="dt">y =</span> <span class="st">&quot;Residuals&quot;</span>,</span>
<span id="cb48-27"><a href="#cb48-27"></a>    <span class="dt">x =</span> <span class="st">&quot;Fitted&quot;</span></span>
<span id="cb48-28"><a href="#cb48-28"></a>  )</span>
<span id="cb48-29"><a href="#cb48-29"></a></span>
<span id="cb48-30"><a href="#cb48-30"></a><span class="co"># combine graphs</span></span>
<span id="cb48-31"><a href="#cb48-31"></a>random_forest_panel &lt;-<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>), <span class="dt">label_size =</span> <span class="dv">12</span>, <span class="dt">ncol =</span><span class="dv">2</span>)</span>
<span id="cb48-32"><a href="#cb48-32"></a></span>
<span id="cb48-33"><a href="#cb48-33"></a><span class="kw">ggsave</span>(<span class="dt">filename =</span> here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;random_forest_panel.png&quot;</span>),</span>
<span id="cb48-34"><a href="#cb48-34"></a>       <span class="dt">plot =</span> random_forest_panel,</span>
<span id="cb48-35"><a href="#cb48-35"></a>       <span class="dt">width =</span> <span class="dv">12</span>, <span class="dt">height =</span> <span class="dv">6</span>)</span>
<span id="cb48-36"><a href="#cb48-36"></a></span>
<span id="cb48-37"><a href="#cb48-37"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>( here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;random_forest_panel.png&quot;</span>))</span></code></pre></div>
<p><img src="tidytuesday2_figures/random_forest_panel.png" width="1800" /></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co"># looking at model performance</span></span>
<span id="cb49-2"><a href="#cb49-2"></a>rf_perfomance &lt;-<span class="st"> </span>rf_res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">show_best</span>(<span class="dt">n =</span> <span class="dv">1</span>)</span>
<span id="cb49-3"><a href="#cb49-3"></a><span class="kw">print</span>(rf_perfomance) <span class="co"># rmse: 0.0059</span></span></code></pre></div>
<pre><code>## # A tibble: 1 x 8
##    mtry min_n .metric .estimator    mean     n  std_err .config              
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;        &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt; &lt;chr&gt;                
## 1    63     8 rmse    standard   0.00520    25 0.000515 Preprocessor1_Model09</code></pre>
<p>The RMSE is larger than LASSO model but smaller than the tree regression model. The predicted vs observed and residual plots look good.</p>
</div>
<div id="support-vector-machines" class="section level2">
<h2>Support vector machines</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co"># model specification </span></span>
<span id="cb51-2"><a href="#cb51-2"></a>svm_spec &lt;-<span class="st"> </span></span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="st">  </span><span class="kw">svm_linear</span>(  </span>
<span id="cb51-4"><a href="#cb51-4"></a>  <span class="dt">cost =</span> <span class="kw">tune</span>(), </span>
<span id="cb51-5"><a href="#cb51-5"></a>  <span class="dt">margin =</span> <span class="kw">tune</span>()) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-6"><a href="#cb51-6"></a><span class="st">  </span><span class="kw">set_engine</span>(<span class="st">&quot;LiblineaR&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-7"><a href="#cb51-7"></a><span class="st">  </span><span class="kw">set_mode</span>(<span class="st">&quot;regression&quot;</span>) </span>
<span id="cb51-8"><a href="#cb51-8"></a></span>
<span id="cb51-9"><a href="#cb51-9"></a></span>
<span id="cb51-10"><a href="#cb51-10"></a><span class="co"># create workflow to bundle model spec and recipe</span></span>
<span id="cb51-11"><a href="#cb51-11"></a>svm_wf &lt;-<span class="st"> </span><span class="kw">workflow</span>() <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-12"><a href="#cb51-12"></a><span class="st">  </span><span class="kw">add_model</span>(svm_spec) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb51-13"><a href="#cb51-13"></a><span class="st">  </span><span class="kw">add_recipe</span>(rec_all_pred)</span></code></pre></div>
</div>
<div id="svm-tuning" class="section level2">
<h2>SVM tuning</h2>
</div>
</div>
<div id="fix-issue-with-parallel-computing-back-end-for-dopar" class="section level1">
<h1>fix issue with parallel computing back-end for dopar</h1>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>unregister_dopar &lt;-<span class="st"> </span><span class="cf">function</span>() {</span>
<span id="cb52-2"><a href="#cb52-2"></a>  env &lt;-<span class="st"> </span>foreach<span class="op">:::</span>.foreachGlobals</span>
<span id="cb52-3"><a href="#cb52-3"></a>  <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">ls</span>(<span class="dt">name=</span>env), <span class="dt">pos=</span>env)</span>
<span id="cb52-4"><a href="#cb52-4"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="co"># parallel computing</span></span>
<span id="cb53-2"><a href="#cb53-2"></a>doParallel<span class="op">::</span><span class="kw">registerDoParallel</span>()</span>
<span id="cb53-3"><a href="#cb53-3"></a></span>
<span id="cb53-4"><a href="#cb53-4"></a><span class="co"># # bootstrapping </span></span>
<span id="cb53-5"><a href="#cb53-5"></a><span class="co"># set.seed(123)</span></span>
<span id="cb53-6"><a href="#cb53-6"></a><span class="co"># iono_rs &lt;- bootstraps(train_data, times = 30)</span></span>
<span id="cb53-7"><a href="#cb53-7"></a></span>
<span id="cb53-8"><a href="#cb53-8"></a><span class="co"># finalize the parameter ranges before optimizing </span></span>
<span id="cb53-9"><a href="#cb53-9"></a>svm_parms &lt;-<span class="st"> </span>svm_spec  <span class="op">%&gt;%</span></span>
<span id="cb53-10"><a href="#cb53-10"></a><span class="st">  </span>dials<span class="op">::</span><span class="kw">parameters</span>() <span class="op">%&gt;%</span></span>
<span id="cb53-11"><a href="#cb53-11"></a><span class="st">  </span>dials<span class="op">::</span><span class="kw">finalize</span>(train_data <span class="op">%&gt;%</span><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>titerincrease))</span>
<span id="cb53-12"><a href="#cb53-12"></a></span>
<span id="cb53-13"><a href="#cb53-13"></a><span class="co"># Optimization of model parameters via simulated annealing</span></span>
<span id="cb53-14"><a href="#cb53-14"></a>svm_res &lt;-<span class="st"> </span>svm_wf <span class="op">%&gt;%</span></span>
<span id="cb53-15"><a href="#cb53-15"></a><span class="st">  </span><span class="kw">tune_sim_anneal</span>(</span>
<span id="cb53-16"><a href="#cb53-16"></a>    <span class="dt">resamples =</span> folds,</span>
<span id="cb53-17"><a href="#cb53-17"></a>    <span class="dt">metrics =</span> <span class="kw">metric_set</span>(rmse),</span>
<span id="cb53-18"><a href="#cb53-18"></a>    <span class="dt">control =</span> <span class="kw">control_sim_anneal</span>(</span>
<span id="cb53-19"><a href="#cb53-19"></a>      <span class="dt">verbose =</span> <span class="ot">TRUE</span>,</span>
<span id="cb53-20"><a href="#cb53-20"></a>      <span class="dt">no_improve =</span> <span class="dv">10</span>,</span>
<span id="cb53-21"><a href="#cb53-21"></a>      <span class="dt">radius =</span> <span class="kw">c</span>(<span class="fl">0.01</span>, <span class="fl">0.25</span>),</span>
<span id="cb53-22"><a href="#cb53-22"></a>      <span class="dt">cooling_coef =</span> <span class="fl">0.01</span></span>
<span id="cb53-23"><a href="#cb53-23"></a>    ),</span>
<span id="cb53-24"><a href="#cb53-24"></a>    <span class="dt">iter =</span> <span class="dv">10</span>,</span>
<span id="cb53-25"><a href="#cb53-25"></a>    <span class="dt">param_info =</span> svm_parms</span>
<span id="cb53-26"><a href="#cb53-26"></a>  )</span></code></pre></div>
<pre><code>## </code></pre>
<pre><code>## &gt;  Generating a set of 1 initial parameter results</code></pre>
<pre><code>## v Initialization complete</code></pre>
<pre><code>## </code></pre>
<pre><code>## Optimizing rmse</code></pre>
<pre><code>## Initial best: 0.09487</code></pre>
<pre><code>##  1 &lt;3 new best           rmse=0.093905   (+/-0.003484)</code></pre>
<pre><code>##  2 ( ) accept suboptimal  rmse=0.10092   (+/-0.00391)</code></pre>
<pre><code>##  3 &lt;3 new best           rmse=0.089384   (+/-0.003136)</code></pre>
<pre><code>##  4 - discard suboptimal rmse=0.10895 (+/-0.004231)</code></pre>
<pre><code>##  5 &lt;3 new best           rmse=0.084611   (+/-0.00166)</code></pre>
<pre><code>##  6 ( ) accept suboptimal  rmse=0.085066  (+/-0.002311)</code></pre>
<pre><code>##  7 ( ) accept suboptimal  rmse=0.085751  (+/-0.002535)</code></pre>
<pre><code>##  8 ( ) accept suboptimal  rmse=0.087062  (+/-0.002753)</code></pre>
<pre><code>##  9 + better suboptimal  rmse=0.086179    (+/-0.002611)</code></pre>
<pre><code>## 10 - discard suboptimal rmse=0.10655 (+/-0.004151)</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="co"># turn off parallel cluster</span></span>
<span id="cb70-2"><a href="#cb70-2"></a>doParallel<span class="op">::</span><span class="kw">stopImplicitCluster</span>()</span>
<span id="cb70-3"><a href="#cb70-3"></a><span class="kw">unregister_dopar</span>()</span>
<span id="cb70-4"><a href="#cb70-4"></a><span class="co"># stopCluster(cl)</span></span></code></pre></div>
<div id="look-up-model-performance-during-tuning" class="section level2">
<h2>Look up model performance during tuning</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a><span class="co"># plot of performance for different tuning parameters</span></span>
<span id="cb71-2"><a href="#cb71-2"></a>svm_diagnostics &lt;-<span class="st"> </span>svm_res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</span>
<span id="cb71-3"><a href="#cb71-3"></a></span>
<span id="cb71-4"><a href="#cb71-4"></a><span class="kw">ggsave</span>(<span class="dt">filename =</span> here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;svm_diagnostics.png&quot;</span>),</span>
<span id="cb71-5"><a href="#cb71-5"></a>       <span class="dt">plot =</span> svm_diagnostics,</span>
<span id="cb71-6"><a href="#cb71-6"></a>       <span class="dt">width =</span> <span class="dv">12</span>, <span class="dt">height =</span> <span class="dv">6</span>)</span>
<span id="cb71-7"><a href="#cb71-7"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>( here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;svm_diagnostics.png&quot;</span>))</span></code></pre></div>
<p><img src="tidytuesday2_figures/svm_diagnostics.png" width="1800" /></p>
</div>
<div id="svm-model-evaluation" class="section level2">
<h2>SVM model evaluation</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="co"># Select single set of hyperparameter values for our best decision tree model</span></span>
<span id="cb72-2"><a href="#cb72-2"></a>best_svm &lt;-<span class="st"> </span>svm_res <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="st">    </span><span class="kw">select_best</span>(<span class="dt">metric =</span> <span class="st">&quot;rmse&quot;</span>)</span>
<span id="cb72-4"><a href="#cb72-4"></a></span>
<span id="cb72-5"><a href="#cb72-5"></a><span class="co"># Finalize our workflow with best values</span></span>
<span id="cb72-6"><a href="#cb72-6"></a>final_svm_wf &lt;-<span class="st"> </span>svm_wf <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb72-7"><a href="#cb72-7"></a><span class="st">  </span><span class="kw">finalize_workflow</span>(best_svm)</span>
<span id="cb72-8"><a href="#cb72-8"></a></span>
<span id="cb72-9"><a href="#cb72-9"></a><span class="co"># Fit model to training data</span></span>
<span id="cb72-10"><a href="#cb72-10"></a>best_svm_fit_train &lt;-<span class="st"> </span>final_svm_wf <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb72-11"><a href="#cb72-11"></a><span class="st">    </span><span class="kw">fit</span>(<span class="dt">data =</span> train_data)</span>
<span id="cb72-12"><a href="#cb72-12"></a></span>
<span id="cb72-13"><a href="#cb72-13"></a></span>
<span id="cb72-14"><a href="#cb72-14"></a><span class="co"># diagnostic plots</span></span>
<span id="cb72-15"><a href="#cb72-15"></a></span>
<span id="cb72-16"><a href="#cb72-16"></a><span class="co"># getting predicted outcome and residuals</span></span>
<span id="cb72-17"><a href="#cb72-17"></a>svm_train_res &lt;-<span class="st"> </span>best_svm_fit_train  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb72-18"><a href="#cb72-18"></a><span class="st">  </span><span class="kw">augment</span>(<span class="dt">new_data =</span> train_data) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb72-19"><a href="#cb72-19"></a><span class="st">         </span><span class="kw">select</span>(.pred, std_time) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb72-20"><a href="#cb72-20"></a><span class="st">         </span><span class="kw">mutate</span>(<span class="dt">.resid =</span> std_time <span class="op">-</span><span class="st"> </span>.pred)</span>
<span id="cb72-21"><a href="#cb72-21"></a></span>
<span id="cb72-22"><a href="#cb72-22"></a></span>
<span id="cb72-23"><a href="#cb72-23"></a><span class="co"># plot Predictions vs observed values</span></span>
<span id="cb72-24"><a href="#cb72-24"></a>p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(svm_train_res, <span class="kw">aes</span>(<span class="dt">x =</span> std_time, <span class="dt">y =</span> .pred)) <span class="op">+</span></span>
<span id="cb72-25"><a href="#cb72-25"></a><span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">slope =</span> <span class="dv">1</span>, <span class="dt">intercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb72-26"><a href="#cb72-26"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">10</span>)<span class="op">+</span></span>
<span id="cb72-27"><a href="#cb72-27"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="op">-</span><span class="dv">5</span>,<span class="dv">10</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb72-28"><a href="#cb72-28"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb72-29"><a href="#cb72-29"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">theme_cowplot</span>() <span class="op">+</span></span>
<span id="cb72-30"><a href="#cb72-30"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb72-31"><a href="#cb72-31"></a>    <span class="dt">title =</span> <span class="st">&quot;SVM: predicted vs observed&quot;</span>,</span>
<span id="cb72-32"><a href="#cb72-32"></a>    <span class="dt">x =</span> <span class="st">&quot;Observed&quot;</span>,</span>
<span id="cb72-33"><a href="#cb72-33"></a>    <span class="dt">y =</span> <span class="st">&quot;Fitted&quot;</span></span>
<span id="cb72-34"><a href="#cb72-34"></a>  )</span>
<span id="cb72-35"><a href="#cb72-35"></a></span>
<span id="cb72-36"><a href="#cb72-36"></a><span class="co"># Plot model predictions vs residuals</span></span>
<span id="cb72-37"><a href="#cb72-37"></a>p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(svm_train_res, <span class="kw">aes</span>(<span class="dt">y =</span> .resid, <span class="dt">x =</span> .pred)) <span class="op">+</span></span>
<span id="cb72-38"><a href="#cb72-38"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb72-39"><a href="#cb72-39"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb72-40"><a href="#cb72-40"></a><span class="st">  </span>cowplot<span class="op">::</span><span class="kw">theme_cowplot</span>() <span class="op">+</span></span>
<span id="cb72-41"><a href="#cb72-41"></a><span class="st">  </span><span class="kw">labs</span>(</span>
<span id="cb72-42"><a href="#cb72-42"></a>    <span class="dt">title =</span> <span class="st">&quot;SVM: residuals vs fitted&quot;</span>,</span>
<span id="cb72-43"><a href="#cb72-43"></a>    <span class="dt">y =</span> <span class="st">&quot;Residuals&quot;</span>,</span>
<span id="cb72-44"><a href="#cb72-44"></a>    <span class="dt">x =</span> <span class="st">&quot;Fitted&quot;</span></span>
<span id="cb72-45"><a href="#cb72-45"></a>  )</span>
<span id="cb72-46"><a href="#cb72-46"></a></span>
<span id="cb72-47"><a href="#cb72-47"></a><span class="co"># combine graphs</span></span>
<span id="cb72-48"><a href="#cb72-48"></a>svm_panel &lt;-<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(p1, p2, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>), <span class="dt">label_size =</span> <span class="dv">12</span>, <span class="dt">ncol =</span><span class="dv">2</span>)</span>
<span id="cb72-49"><a href="#cb72-49"></a></span>
<span id="cb72-50"><a href="#cb72-50"></a><span class="kw">ggsave</span>(<span class="dt">filename =</span> here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;svm_panel.png&quot;</span>),</span>
<span id="cb72-51"><a href="#cb72-51"></a>       <span class="dt">plot =</span> svm_panel,</span>
<span id="cb72-52"><a href="#cb72-52"></a>       <span class="dt">width =</span> <span class="dv">12</span>, <span class="dt">height =</span> <span class="dv">6</span>)</span>
<span id="cb72-53"><a href="#cb72-53"></a></span>
<span id="cb72-54"><a href="#cb72-54"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>( here<span class="op">::</span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;svm_panel.png&quot;</span>))</span></code></pre></div>
<p><img src="tidytuesday2_figures/svm_panel.png" width="1800" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co"># looking at model performance</span></span>
<span id="cb73-2"><a href="#cb73-2"></a>svm_perfomance &lt;-<span class="st"> </span>svm_res <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">show_best</span>(<span class="dt">n =</span> <span class="dv">1</span>)</span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="kw">print</span>(svm_perfomance) <span class="co"># rmse: 0.0492</span></span></code></pre></div>
<pre><code>## # A tibble: 1 x 9
##    cost margin .metric .estimator   mean     n std_err .config .iter
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;int&gt;
## 1  2.34 0.0955 rmse    standard   0.0846    25 0.00166 Iter5       5</code></pre>
<p>The linear SVM model only predicted values of the standardized race time in a very small range, which looks like a single distinct value after rescaling, and the RMSE is the largest among all models so far. I should probably try other kernel SVM models such as polynomial or radical basis function that performs better for nonlinear decision boundary.</p>
</div>
</div>
<div id="null-rmse-with-standard-error" class="section level1">
<h1>Null RMSE with standard error</h1>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co"># Calculate the null RMSE and SE by boostrapping</span></span>
<span id="cb75-2"><a href="#cb75-2"></a>res &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">1000</span>)</span>
<span id="cb75-3"><a href="#cb75-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) {</span>
<span id="cb75-4"><a href="#cb75-4"></a>  Bi &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">unlist</span>(train_data[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(train_data), <span class="dt">size =</span> <span class="kw">nrow</span>(train_data), <span class="dt">replace =</span> <span class="ot">TRUE</span>), <span class="st">&quot;std_time&quot;</span>]))</span>
<span id="cb75-5"><a href="#cb75-5"></a>  res[i] &lt;-<span class="st"> </span><span class="kw">rmse_vec</span>(</span>
<span id="cb75-6"><a href="#cb75-6"></a>    <span class="dt">truth =</span> Bi, <span class="dt">estimate =</span> <span class="kw">rep</span>(<span class="kw">mean</span>(train_data<span class="op">$</span>std_time), <span class="kw">nrow</span>(train_data))</span>
<span id="cb75-7"><a href="#cb75-7"></a>  )</span>
<span id="cb75-8"><a href="#cb75-8"></a>}</span>
<span id="cb75-9"><a href="#cb75-9"></a>null_rmse &lt;-<span class="st"> </span><span class="kw">tibble</span>(</span>
<span id="cb75-10"><a href="#cb75-10"></a>  <span class="dt">estimate =</span> <span class="kw">rmse_vec</span>(<span class="dt">truth =</span> train_data<span class="op">$</span>std_time,</span>
<span id="cb75-11"><a href="#cb75-11"></a>                      <span class="dt">estimate =</span> <span class="kw">rep</span>(<span class="kw">mean</span>(train_data<span class="op">$</span>std_time), <span class="kw">nrow</span>(train_data))),</span>
<span id="cb75-12"><a href="#cb75-12"></a>  <span class="dt">std_err =</span> <span class="kw">sd</span>(res)</span>
<span id="cb75-13"><a href="#cb75-13"></a>)</span>
<span id="cb75-14"><a href="#cb75-14"></a></span>
<span id="cb75-15"><a href="#cb75-15"></a>null_rmse  <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-16"><a href="#cb75-16"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">everything</span>(), <span class="op">~</span><span class="kw">round</span>(.x, <span class="dt">digits =</span> <span class="dv">4</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb75-17"><a href="#cb75-17"></a><span class="st">  </span>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="dt">caption =</span> <span class="st">&quot;RMSE and boostrap SE (B = 1000) for the null model.&quot;</span>)</span></code></pre></div>
<table>
<caption>
RMSE and boostrap SE (B = 1000) for the null model.
</caption>
<thead>
<tr>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std_err
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
0.0299
</td>
<td style="text-align:right;">
0.0026
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a>tree_RMSE &lt;-<span class="st"> </span>tree_res  <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="st">  </span><span class="kw">show_best</span>(<span class="dt">n =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb76-3"><a href="#cb76-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">estimate =</span> mean, std_err) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-4"><a href="#cb76-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(null_rmse) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-5"><a href="#cb76-5"></a><span class="st">    </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(</span>
<span id="cb76-6"><a href="#cb76-6"></a>    <span class="dt">model =</span> <span class="kw">c</span>(<span class="st">&quot;Tree&quot;</span>, <span class="st">&quot;Null&quot;</span>),</span>
<span id="cb76-7"><a href="#cb76-7"></a>    <span class="dt">rmse =</span> <span class="kw">round</span>(estimate, <span class="dv">2</span>),</span>
<span id="cb76-8"><a href="#cb76-8"></a>    <span class="dt">SE =</span> <span class="kw">round</span>(std_err, <span class="dv">4</span>),</span>
<span id="cb76-9"><a href="#cb76-9"></a>    <span class="dt">.keep =</span> <span class="st">&quot;unused&quot;</span></span>
<span id="cb76-10"><a href="#cb76-10"></a>  )</span>
<span id="cb76-11"><a href="#cb76-11"></a></span>
<span id="cb76-12"><a href="#cb76-12"></a>svm_RMSE &lt;-<span class="st"> </span>svm_res  <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb76-13"><a href="#cb76-13"></a><span class="st">  </span><span class="kw">show_best</span>(<span class="dt">n =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb76-14"><a href="#cb76-14"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(</span>
<span id="cb76-15"><a href="#cb76-15"></a>    <span class="dt">rmse =</span> <span class="kw">round</span>(mean, <span class="dv">2</span>),</span>
<span id="cb76-16"><a href="#cb76-16"></a>    <span class="dt">SE =</span> <span class="kw">round</span>(std_err, <span class="dv">4</span>),</span>
<span id="cb76-17"><a href="#cb76-17"></a>    <span class="dt">model =</span> <span class="st">&quot;SVM&quot;</span></span>
<span id="cb76-18"><a href="#cb76-18"></a>  ) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb76-19"><a href="#cb76-19"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(tree_RMSE)</span>
<span id="cb76-20"><a href="#cb76-20"></a></span>
<span id="cb76-21"><a href="#cb76-21"></a>rf_RMSE &lt;-<span class="st"> </span>rf_res  <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb76-22"><a href="#cb76-22"></a><span class="st">  </span><span class="kw">show_best</span>(<span class="dt">n =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb76-23"><a href="#cb76-23"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(</span>
<span id="cb76-24"><a href="#cb76-24"></a>    <span class="dt">rmse =</span> <span class="kw">round</span>(mean, <span class="dv">2</span>),</span>
<span id="cb76-25"><a href="#cb76-25"></a>    <span class="dt">SE =</span> <span class="kw">round</span>(std_err, <span class="dv">4</span>),</span>
<span id="cb76-26"><a href="#cb76-26"></a>    <span class="dt">model =</span> <span class="st">&quot;Random Forest&quot;</span></span>
<span id="cb76-27"><a href="#cb76-27"></a>  ) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb76-28"><a href="#cb76-28"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(svm_RMSE)</span>
<span id="cb76-29"><a href="#cb76-29"></a></span>
<span id="cb76-30"><a href="#cb76-30"></a>all_RMSE &lt;-<span class="st"> </span>lasso_res  <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb76-31"><a href="#cb76-31"></a><span class="st">  </span><span class="kw">show_best</span>(<span class="dt">n =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb76-32"><a href="#cb76-32"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(</span>
<span id="cb76-33"><a href="#cb76-33"></a>    <span class="dt">rmse =</span> <span class="kw">round</span>(mean, <span class="dv">2</span>),</span>
<span id="cb76-34"><a href="#cb76-34"></a>    <span class="dt">SE =</span> <span class="kw">round</span>(std_err, <span class="dv">4</span>),</span>
<span id="cb76-35"><a href="#cb76-35"></a>    <span class="dt">model =</span> <span class="st">&quot;LASSO&quot;</span></span>
<span id="cb76-36"><a href="#cb76-36"></a>  ) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb76-37"><a href="#cb76-37"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">bind_rows</span>(rf_RMSE) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb76-38"><a href="#cb76-38"></a><span class="st">  </span>gt<span class="op">::</span><span class="kw">gt</span>(<span class="dt">caption =</span> <span class="st">&quot;Comparison of RMSE values for all models.&quot;</span>)</span>
<span id="cb76-39"><a href="#cb76-39"></a></span>
<span id="cb76-40"><a href="#cb76-40"></a></span>
<span id="cb76-41"><a href="#cb76-41"></a>all_RMSE</span></code></pre></div>
<div id="inxunrfthu" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#inxunrfthu .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#inxunrfthu .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#inxunrfthu .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#inxunrfthu .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#inxunrfthu .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#inxunrfthu .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#inxunrfthu .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#inxunrfthu .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#inxunrfthu .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#inxunrfthu .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#inxunrfthu .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#inxunrfthu .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#inxunrfthu .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#inxunrfthu .gt_from_md > :first-child {
  margin-top: 0;
}

#inxunrfthu .gt_from_md > :last-child {
  margin-bottom: 0;
}

#inxunrfthu .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#inxunrfthu .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#inxunrfthu .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#inxunrfthu .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#inxunrfthu .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#inxunrfthu .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#inxunrfthu .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#inxunrfthu .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#inxunrfthu .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#inxunrfthu .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#inxunrfthu .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#inxunrfthu .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#inxunrfthu .gt_left {
  text-align: left;
}

#inxunrfthu .gt_center {
  text-align: center;
}

#inxunrfthu .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#inxunrfthu .gt_font_normal {
  font-weight: normal;
}

#inxunrfthu .gt_font_bold {
  font-weight: bold;
}

#inxunrfthu .gt_font_italic {
  font-style: italic;
}

#inxunrfthu .gt_super {
  font-size: 65%;
}

#inxunrfthu .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  <caption>Comparison of RMSE values for all models.</caption>
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">rmse</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">SE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">model</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">0.00</td>
<td class="gt_row gt_right">0.0000</td>
<td class="gt_row gt_left">LASSO</td></tr>
    <tr><td class="gt_row gt_right">0.01</td>
<td class="gt_row gt_right">0.0005</td>
<td class="gt_row gt_left">Random Forest</td></tr>
    <tr><td class="gt_row gt_right">0.08</td>
<td class="gt_row gt_right">0.0017</td>
<td class="gt_row gt_left">SVM</td></tr>
    <tr><td class="gt_row gt_right">0.01</td>
<td class="gt_row gt_right">0.0005</td>
<td class="gt_row gt_left">Tree</td></tr>
    <tr><td class="gt_row gt_right">0.03</td>
<td class="gt_row gt_right">0.0026</td>
<td class="gt_row gt_left">Null</td></tr>
  </tbody>
  
  
</table>
</div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co"># save RMSE comparison table </span></span>
<span id="cb77-2"><a href="#cb77-2"></a>rmse_location =<span class="st"> </span><span class="kw">here</span>(<span class="st">&quot;tidytuesday2_figures&quot;</span>, <span class="st">&quot;rmsecomparison.Rds&quot;</span>)</span>
<span id="cb77-3"><a href="#cb77-3"></a><span class="kw">saveRDS</span>(all_RMSE, <span class="dt">file =</span> rmse_location)</span></code></pre></div>
<div id="model-selection" class="section level2">
<h2>Model selection</h2>
<p>We can see that LASSO had best fit compared to all other models. The predicted vs observed plot looks good, all the data points align well on the diagonal. So, I will fit the chosen LASSO model to the test data and evaluate the performance.</p>
</div>
<div id="final-evaluation" class="section level2">
<h2>Final evaluation</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="co"># evaluate how model perform on test set</span></span>
<span id="cb78-2"><a href="#cb78-2"></a>last_rf_fit &lt;-<span class="st"> </span>final_lasso_wf <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-3"><a href="#cb78-3"></a><span class="st">  </span><span class="kw">last_fit</span>(<span class="dt">split =</span> data_split, </span>
<span id="cb78-4"><a href="#cb78-4"></a>                 <span class="dt">metrics =</span> <span class="kw">metric_set</span>(rmse))</span>
<span id="cb78-5"><a href="#cb78-5"></a></span>
<span id="cb78-6"><a href="#cb78-6"></a>last_rf_fit <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb78-7"><a href="#cb78-7"></a><span class="st">  </span><span class="kw">collect_metrics</span>()</span></code></pre></div>
<pre><code>## # A tibble: 1 x 4
##   .metric .estimator .estimate .config             
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
## 1 rmse    standard    0.000757 Preprocessor1_Model1</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="co"># rmse for LASSO model fitting on testing data</span></span>
<span id="cb80-2"><a href="#cb80-2"></a>lasso_test_rmse &lt;-<span class="st"> </span><span class="kw">collect_metrics</span>(last_rf_fit) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb80-3"><a href="#cb80-3"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="dt">rmse =</span> .estimate) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb80-4"><a href="#cb80-4"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">data =</span> <span class="st">&quot;testing&quot;</span>)</span>
<span id="cb80-5"><a href="#cb80-5"></a></span>
<span id="cb80-6"><a href="#cb80-6"></a><span class="co"># rmse for LASSO model fitting on training data  </span></span>
<span id="cb80-7"><a href="#cb80-7"></a>lasso_RMSE_train &lt;-<span class="st"> </span>lasso_res <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb80-8"><a href="#cb80-8"></a><span class="st">  </span><span class="kw">show_best</span>(<span class="dt">n =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb80-9"><a href="#cb80-9"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(</span>
<span id="cb80-10"><a href="#cb80-10"></a>    <span class="dt">rmse =</span> <span class="kw">round</span>(mean, <span class="dv">4</span>),</span>
<span id="cb80-11"><a href="#cb80-11"></a>    <span class="dt">SE =</span> <span class="kw">round</span>(std_err, <span class="dv">4</span>),</span>
<span id="cb80-12"><a href="#cb80-12"></a>    <span class="dt">model =</span> <span class="st">&quot;LASSO&quot;</span></span>
<span id="cb80-13"><a href="#cb80-13"></a>  ) </span>
<span id="cb80-14"><a href="#cb80-14"></a></span>
<span id="cb80-15"><a href="#cb80-15"></a>lasso_RMSE_train <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb80-16"><a href="#cb80-16"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">transmute</span>(</span>
<span id="cb80-17"><a href="#cb80-17"></a>    rmse, <span class="dt">data =</span> <span class="st">&quot;training&quot;</span></span>
<span id="cb80-18"><a href="#cb80-18"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb80-19"><a href="#cb80-19"></a><span class="st">  </span><span class="kw">bind_rows</span>(lasso_test_rmse) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb80-20"><a href="#cb80-20"></a><span class="st">  </span>gt<span class="op">::</span><span class="kw">gt</span>(<span class="dt">caption =</span> <span class="st">&quot;Comparison of RMSE between traing and testing data using LASSO regression.&quot;</span>)</span></code></pre></div>
<div id="dpncgnjzjg" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#dpncgnjzjg .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dpncgnjzjg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dpncgnjzjg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dpncgnjzjg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dpncgnjzjg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dpncgnjzjg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dpncgnjzjg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dpncgnjzjg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dpncgnjzjg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dpncgnjzjg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dpncgnjzjg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dpncgnjzjg .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#dpncgnjzjg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dpncgnjzjg .gt_from_md > :first-child {
  margin-top: 0;
}

#dpncgnjzjg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dpncgnjzjg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dpncgnjzjg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#dpncgnjzjg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dpncgnjzjg .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#dpncgnjzjg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dpncgnjzjg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dpncgnjzjg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dpncgnjzjg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dpncgnjzjg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dpncgnjzjg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#dpncgnjzjg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dpncgnjzjg .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#dpncgnjzjg .gt_left {
  text-align: left;
}

#dpncgnjzjg .gt_center {
  text-align: center;
}

#dpncgnjzjg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dpncgnjzjg .gt_font_normal {
  font-weight: normal;
}

#dpncgnjzjg .gt_font_bold {
  font-weight: bold;
}

#dpncgnjzjg .gt_font_italic {
  font-style: italic;
}

#dpncgnjzjg .gt_super {
  font-size: 65%;
}

#dpncgnjzjg .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 65%;
}
</style>
<table class="gt_table">
  <caption>Comparison of RMSE between traing and testing data using LASSO regression.</caption>
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1">rmse</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1">data</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td class="gt_row gt_right">0.0009000000</td>
<td class="gt_row gt_left">training</td></tr>
    <tr><td class="gt_row gt_right">0.0007565904</td>
<td class="gt_row gt_left">testing</td></tr>
  </tbody>
  
  
</table>
</div>
<p>The result shows that the final LASSO model fits were similar between training and testing data.</p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
